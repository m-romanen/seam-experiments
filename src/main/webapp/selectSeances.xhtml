<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.org/schema/seam/taglib"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
<title>Select your seance</title>
</h:head>

<h:body>
		<h:form id="selectSeancesForm">
			<ui:include src="headerPanel.xhtml" />
			<div>
				<h:outputText value="You choosed film: #{selectedFilm.name} | Duration: #{selectedFilm.duration} mins. " />
				<h:commandLink action="#{filmSelection.chooseAnotherFilm}" value="Choose another film" />
			</div>
			<ui:repeat value="#{seances}" var="seanceItem">
				<h:panelGrid columns="2" id="id#{seanceItem.id}"
					style="display:inline-block;width:33%;float:left">
					<h:outputLabel value="Hall: " />
					<h:outputText value="#{seanceItem.hall.name}" />
					<h:outputLabel value="Start date: " />
					<h:outputText value="#{seanceItem.start_date}">
						<f:convertDateTime pattern="dd.MM.yyyy HH:mm" />
					</h:outputText>
					<h:outputLabel value="Choose row: " />
					<h:selectOneMenu value="#{seanceItem.selectedRowId}">
						<f:selectItem itemValue="#{null}" itemLabel="--select--" />
						<f:selectItems value="#{seanceItem.hall.rows}" var="rowItem" itemValue="#{rowItem.id}" itemLabel="#{rowItem.number}"/>
						<f:ajax event="change" render="@form" execute="@form" listener="#{reservationProcess.onRowSelect()}"/>
					</h:selectOneMenu>
					<h:outputLabel value="Choose place: " />
					<h:selectOneMenu value="#{seanceItem.selectedPlaceId}" >
						<f:selectItem itemValue="#{null}" itemLabel="--select--" />
						<f:selectItems value="#{seanceItem.filteredPlaces}" var="placeItem" itemValue="#{placeItem.id}" itemLabel="#{placeItem.number}"/>
						<f:ajax event="change" render="@form" execute="@form"/>
					</h:selectOneMenu>
					<h:outputLabel value="Price: " />
					<h:outputText value="#{seanceItem.price}" />
					<h:commandButton action="#{reservationProcess.reserve}" disabled="#{seanceItem.selectedPlaceId == null}"
						value="Reserve" />
				</h:panelGrid>
			</ui:repeat>
		</h:form>
</h:body>


</ui:composition>
